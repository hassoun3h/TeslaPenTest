# TeslaPenTest
We conducted a penetration test on a Tesla Model 3 using the PTES (Penetration Testing Execution Standard) guidelines. Overall, Tesla seems very secure against cybersecurity attacks. They have implemented safeguards and with their defense-in-depth approach through security modes such as Sentry Mode, Valet Mode, Cabin camera, security alarm, and intrusion sensors, they should remain secure. However, their main security focus is security through obscurity, so we believe that, if more information about the car systems gets disclosed, it'll be easier to break those systems. 


# Threat Modeling a Tesla in Today’s Day and Age Through the Scope of a Penetration Test

By Zayn Yousef, Jessica Sargent, Brian Loomba, and Erman Mercan

###### 1 Pre engagement interactions

For our scope of test, we looked into four different attack vectors. Those attacks we aim to address when assessing our pre engagement interactions are: if a supply chain attack would work on Tesla's infrastructure and be able to be carried out into the updates that are rolled out to Tesla's cars, to obtain user credentials of the Tesla Model 3 through a packet capture/packet injection over the wire or attempt to compromise the CIA of a Tesla vehicle via a Bluetooth attack. If none of that works, to see if a social engineering attack could give us access to the vehicle or the credentials of the owner, which could potentially lead to obtaining more information that can be used to further the severity of the attack.

**Supply chain attack:**

A supply chain attack, also known as a value-chain or third-party attack, occurs when an unknown malicious user, normally APTs, infiltrates a system through an outside partner or provider with access to the systems and data in order to install undetectable malware for the purpose of bringing harm to a player further down the supply chain network.

**Man-in-the-middle attack:**

A man-in-the-middle attack is like eavesdropping. An attacker listens to the communication between the user and the entity. When data is sent between a computer and a server, a cybercriminal can get in between and spy. This attack requires three players: the victim, the entity with which the victim is trying to communicate, and the "man in the middle" who's intercepting the victim's communications. As it aims to circumvent mutual authentication, a MITM attack can succeed only when the attacker impersonates each endpoint sufficiently well to satisfy their expectations. Packet injection in computer networking is the process of interfering with an established network connection by means of constructing packets to appear as if they are part of the normal communication stream.
MITM attacks use a variety of techniques including sniffing, packet injection, session hijacking, and SSL stripping.
The way to do this is by injecting their own packets into the data stream. The packets injected by the hacker will appear as normal packets. This causes malicious activity to be overlooked and ignored.

**Bluesnarfing attack:**

Bluesnarfing is an attack that involves the theft of data including contact lists, calendars, emails, or text messages from a Bluetooth-enabled wireless device set to “discoverable” mode.

**Social Engineering attack:**

In the context of information security, social engineering is the psychological manipulation of people into performing actions or divulging confidential information. So basically, we’re trying to trick the user into revealing personal information.

###### 2 Intelligence Gathering**

**Supply chain attack:**

For semi-passive OSINT, we found that most cars and parts of Tesla are manufactured by Tesla except for the batteries. The top 3 battery companies that Tesla uses for supply are Panasonic, CATL, and LG Energy Solutions.
All of the information needed for this attack was obtained through a third-party website, such as forums on Reddit, and the Tesla manual. According to the Tesla Model 3 Manual, there are two update preferences available: Standard and Advanced. The Standard mode is when you “receive software updates using the normal rollout timeframe for your region and vehicle configuration. When a software release is made available it has generally been running on other customer vehicles for a period of time.” For the Advanced version you can “receive the latest software updates for your region and vehicle configuration as soon as they are available. Tesla determines how, when, and where to send updates to vehicles based on various factors unique to each release.”
Despite having Standard and Advanced update options available there is also the mystical Early Access Program. It’s unknown how users can join it. From my research online, Tesla reaches out to the user if they want them to be a part of the Early Access Program -- in a forum, a user jokes, “the first rule of EAP is never talk about EAP”. The rumored qualifications for EAP are your location, what model Tesla you have, what trim level/options you have, and your driving habits.

**Man-in-the-middle attack:**

For passive OSINT, we researched Tesla.com, however, we are aware that visiting the website directly is considered active recon, but by doing this from a different IP than the one used for the attack we avoid any detection. There is also a Github Tesla buildroot repository giving access to the kernel and Powershell 2.0 scripts used by the API to communicate. The touch screen interface is hosted on an Ubuntu server.

For semi-passive OSINT, the attacker could profile target methods that appear as normal internet traffic and behavior such as creating a user account at auth.tesla.com. We created a fake account under the name Peter Malone, but that did not give us access to much because you need a vehicle VIN number to register.
For active OSINT, we were fortunate enough to have access to a Tesla Model 3. We conducted an nmap -sV which is a service version detection scan, and nmap -O which detects the operating system, on the IP address of the Tesla Model 3 which was 192.168.1.215 which was on a LAN for the Tesla Model 3. The results of the nmap -O scan stated that the device types were a webcam, a power device, general-purpose, a router, and a media device. 
We ran a nmap scan on our network 192.168.1.0/24 and were able to retrieve the IP for the Tesla Model 3 connected to our WIFI.
We also ran a nmap -sV and nmap -O scans on the vehicle giving us all filtered ports.
We also attempted to capture packets using Wireshark and WIFI using Mac OSX and we were not successful. 
A nessus scan of the Tesla led to a vulnerability discovery: Tesla Model 3 allows for ICMP, but this was unsuccessful when we tried to ping 192.168.1.215 which was the vehicle’s IP address on our network. 

**Bluesnarfing attack:**

For passive OSINT, through researching the security history of Teslas we found that they have been compromised in the past, but they are patched relatively quickly. A Bluetooth attack was discovered in early 2021 that allowed a malicious actor to rewrite the firmware code of the key fob via Bluetooth. This vulnerability was quickly patched.
For Active OSINT, the Kali bluesnarfer command could be used to pull particular data points that would violate key principles of CIA. The -r option allows the user to read the contents of the contact list, their received call list, and the Bluetooth device address, and even delete contacts.

**Social Engineering attack:**

For passive OSINT, an attacker would be able to check the social media accounts of the Tesla owner; for example, their LinkedIn profile to see where they work and where the car would be parked during the day. An email address might also be available online. Some Tesla users also create content for YouTube or forums using their cars.
For semi-passive OSINT, an attacker could attempt to fake user credentials to see how the login process works and what type of error message shows up.
For active OSINT, the attacker could pretend to be someone looking for advice on a professional level, or pretend that the attacker would like to connect with the Tesla owner for a Tesla car club, etc to get contact information/email address. 
For active reconnaissance, if a username or email address were found, an attacker could try brute-forcing the victim’s password using THC Hydra. We’re relying on the human mistake here, hoping the victim’s password isn’t too strong. Trying to brute force the username/password of the Tesla app resulted in being locked out after six wrong passwords when using a legitimate username.

###### 3 Threat Modeling

**Supply chain attack:**

Information on how Tesla Motors rolls out its updates is very secretive. Tesla is very careful about how much information they disclose. Tesla’s primary assets are 1) the software and firmware updates and 2) the process of rolling out the updates. They maintain a high level of secrecy regarding those processes.
However, if someone with malicious intent was able to breach the network and write in malware to the latest update, this could be detrimental because according to the Tesla Model 3 Manual, “reverting to a previous software version is not possible.”

**Man-in-the-middle attack:**

A man-in-the-middle attack could be conducted over a private LAN or public WIFI network. If the Tesla was connected to a public WIFI network, an attacker could capture network packets using Wireshark and a WIFI adapter with monitor mode enabled using the commands airmon-ng start <interface>, airodump-ng <interface>, on Mac OS X, and a Macbook Pro. However, it is necessary to have an over-the-wire connection. 

**Bluesnarfing attack:**

A Bluesnarfing attack could be carried out at a Tesla charging station. If the Tesla was running and no one was currently connected to the Bluetooth, an attacker could initiate a Bluetooth connection to successfully exfiltrate PII.
The business and operational requirements for Tesla’s Bluetooth feature are the ease of use and operating the vehicle without any hindrance to their safety/privacy. Furthermore, the Bluetooth connection is not possible unless the phone is in close proximity to the vehicle and the vehicle is turned on.

**Social Engineering attack:**

A spear phishing email could be sent to the owner of a Tesla with one of two things:
A keylogger, which is a script that captures and sends the victim’s keystrokes to the attacker via email.
A link to a fake login page that is identical to Tesla’s login page, hosted on the attacker’s server sending the victim’s credentials to the attacker.
The Social Engineering Toolkit could be used to accomplish this task.

###### 4 Vulnerability Analysis

With Tesla’s networking structure and update rollout process being so secretive, it is difficult to determine their vulnerabilities except theoretically.
Software/firmware - actual code of software/firmware
Update schedule - timing of how the software/firmware will be rolled out
Network - how the updates are rolled out over-the-air
Physical - access/control of a Tesla car
Human element - this being the weakest link in every organization, a social engineering attack would be the attack with the highest success rate. 

###### 5 Exploitation

**Supply chain attack:**

In order for a supply chain attack to work, the user would have to gain access to Tesla’s computing/networking system; most likely through the use of a back door. By installing a rootkit, the hacker would be able to introduce malware into the updates rolled out to the Tesla cars.
This could happen in various ways: if an employee found an unknown USB drive in the parking lot and plugged it into a computer in Tesla’s headquarters which would be an accidental threat. An adversarial threat would be if a hacker was able to breach the network of Tesla through a discovered back door or open port/service on the network, or if an insider threat accessed the hardware before it was installed into the Tesla.

**Man-in-the-middle attack:**

If an attacker was able to conduct a man-in-the-middle attack by sitting in between the connection of a Tesla owner and the communication to the car, they would be able to capture and alter packets that are sent over the air. This is called packet sniffing. The commands you would use are airmon-ng check kill, this will kill all the running processes that would interfere, airmon-ng start <interface>, and airodump-ng <interface>, WIFI monitor mode must also be enabled. 
  
**Bluesnarfing attack:**

In order for the Bluetooth attack to work, the vehicle would have to be running, and the attacker would have to be sitting in the driver’s seat. Due to the priority device feature, the attacker would have to ensure that the true owner was not near the vehicle. After gaining access, the attacker could exfiltrate sensitive data associated with the Tesla and/or steal the car.

**Social Engineering attack:**

If an attacker does not have physical access to the car, an RFID/NFC skimmer could be used to steal the Tesla Key Card (TKC) information.
If an attacker does have physical access to the car, USB ports inside the car could be utilized to attack in two different ways:
A USB drive could be plugged in to install malicious software such as a backdoor on the vehicle’s infotainment system that could lead the attacker to access the victim’s personal information (breach of confidentiality).
A USBKill, which is originally an anti-forensic tool used to kill devices, could be plugged into the USB port in the vehicle. It will send an electrical shock to the infotainment system and leave it unusable which is a breach of availability.

###### 6 Post Exploitation

The goal post exploitation depending on whether the attack is a man-in-the-middle, Bluesnarfing, social engineering, or a supply chain attack is to establish persistence in the system, escalate privileges, collect personal data, and control the Tesla. Once an attacker has gained access to the system, a cron-job could be set up to do many of these things, such as opening a netcat listener each time the vehicle is turned on, starting a Powershell command, or controlling the Tesla.

###### 7 Reporting

While a supply chain attack, a Bluesnarfing attack, a social engineering scheme, or a man-in-the-middle attack, would be harmful to Tesla, overall they have done a decent job at safeguarding against these attacks. The open-source code for the Tesla kernel was difficult to rebuild, and any attempt to remotely control the vehicle failed.

By rolling out updates in random phases, even if an attacker gained access to the network and installed malware, it would only affect a small number of cars rather than every Tesla car as long as it was detected before the updates were rolled out to the next group of cars; this helps to protect against a supply chain attack. A problem we have recognized however is that while Tesla users can report bugs and they are “periodically reviewed,” it isn’t known how often Tesla reviews them. For safety defects “which could cause a crash or could cause injury or death” consumers are to report defects to the National Highway Traffic Safety Administration and also notify Tesla. There are instructions available on how to contact NHTSA, but not Tesla.

Tesla has also updated its Bluetooth technology recently so that it will not pair with a phone until someone is sitting in the vehicle and the Tesla is turned on. This makes Bluesnarfing unlikely to succeed. There’s also a “PIN to Drive” feature that requires a four-digit pin to be entered before the Tesla can be started and driven which provides an additional security feature against Bluesnarfing.

Our attempts to conduct a man-in-the-middle attack were unsuccessful as well. And furthermore, any and all packets we were able to capture were encrypted with layer 7 TLS encryption.


###### Conclusion

In conclusion, while all these attacks could be very critical, Tesla has done a decent job at safeguarding their cars against them. They roll out updates in random phases to small groups of cars, so even if an attacker gained access to the network and installed malware on the update package, it would only affect a small number of cars; this helps reduce the severity of a supply chain attack, as long as the malware is detected before the next roll out. However, one problem that we recognized is that while Tesla users can report bugs and they are “periodically reviewed,” it is unknown how often Tesla actually reviews them. According to the user manual, there are instructions on how to report security defects to the National Highway Traffic Safety Administration, but not on how to report them to Tesla itself. Besides that, we attempted to conduct a man-in-the-middle attack, which was unsuccessful, and all the packets we captured were encrypted with layer 7 encryption. We even tried to rebuild the Linux kernel that Tesla uses in their cars from the source code and the Buildroot tool they shared on their GitHub page; but again, no success. In reality, the attack that could actually work against a Tesla would be the one that exploits its weakest part, the driver. And because of that, we think that a social engineering attack would have the biggest impact among all.
So, from what we saw today, Tesla cars seem to be very secure against cybersecurity attacks. They have implemented a defense-in-depth approach through all the security modes that you see on the screen. However, their main security focus is through obscurity, and we believe that if more information about the car systems get disclosed, it’ll be way easier to break into those systems.



**Video Presentation (Click the image)** 

[![Tesla Model 3 Penetration Test](http://img.youtube.com/vi/-jXuJEuB4Qo/0.jpg)](http://www.youtube.com/watch?v=-jXuJEuB4Qo "Tesla Penetration Test")

